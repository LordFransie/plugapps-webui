{% extends 'apps/apptemplate.html' %}
{% block title %}MiniDLNA{% endblock %}

{% block apppage %}
<script type="text/javascript"><!--


var package_name = "minidlna";

function start() {
$.ajax({
        method: 'GET',
        cache: false,
        url : '/api/startapp?name=' + package_name,
        dataType : 'text',
        success: function (text) { 
            checkStatus();
        }
});
}

function stop() {
$.ajax({
        method: 'GET',
        cache: false,
        url : '/api/stopapp?name=' + package_name,
        dataType : 'text',
        success: function (text) { 
            checkStatus();
        }
});
}

function isInstalled() {
$.ajax({
        method: 'GET',
        cache: false,
        url : '/api/isinstalled?name=' + package_name,
        dataType : 'text',
        success: function (text) { 
            if (text == "False") {
                $('#installstatus').html("Not installed");
            }
            else {
                $('#installstatus').html("Installed");
            }
        }
});
}

function checkStatus() {
$('#runstatus').html('<img style="width:18px;height:18px;margin:0;" src="/static/images/loader.gif"/>');
var startLink =  'Stopped - <a style="text-decoration:underline;" href="#" onclick="javascript:start();">Click here to start</a>'
var stopLink =  'Running - <a style="text-decoration:underline;" href="#" onclick="javascript:stop();">Click here to stop</a>'
$.ajax({
        method: 'GET',
        cache: false,
        url : '/api/isrunning?name=' + package_name,
        dataType : 'text',
        success: function (text) { 
            if (text == "False") {
                $('#runstatus').html(startLink);
            }
            else {
                $('#runstatus').html(stopLink);
            }
        }
});
}

isInstalled();
checkStatus();
--></script>
<div id="apppage">
<h2>Minidlna is: <span id="installstatus"><img style="width:18px;height:18px;margin:0;" src="/static/images/loader.gif"/></span></h2>

<p>Daemon is: <span id="runstatus"><img style="width:18px;height:18px;margin:0;" src="/static/images/loader.gif"/></span></p>
</div><!-- apppage -->
{% endblock %}
